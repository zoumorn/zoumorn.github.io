<!DOCTYPE HTML>
<HTML lang="zh-CN">
    <HEAD>
        <meta http-equiv="content-type" content="text/html; charset=UTF-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1">

        <title>永恒之墙</title>

        <link rel="stylesheet" href="/static/bootstrap.min.css" />
        <link rel="stylesheet" href="/static/main.css" />
        <script type="text/javascript" src="/static/jquery-1.12.4.min.js"></script>
        <script type="text/javascript" src="/static/bootstrap.min.js"></script>
        
        <script>
        
        var payment_method = "alipay";
        function update_payment() {
            var alipay_qr = "/static/img/alipay-qr.jpg";
            var wechatpay_qr = "/static/img/wechatpay-qr.jpg";
            
            var qr = $("#payment-qr");
            if (payment_method == "wechat") {
                qr.attr('src', wechatpay_qr);
                $("#tab-wechat").addClass("active");
                $("#tab-alipay").removeClass("active");
            }
            else {
                qr.attr('src', alipay_qr);
                $("#tab-alipay").addClass("active");
                $("#tab-wechat").removeClass("active");
            }
        }
        
        function show_msg(m) {
            var d = $("#msg");
            d.html(m);
            d.show();
            setTimeout(function() { d.hide(); }, 2000);
        }

        $(function(){
            $("#wechat").click(function(event){
                payment_method = "wechat";
                update_payment();
            });
            $("#alipay").click(function(event){
                payment_method = "alipay";
                update_payment();
            });
            
            $("#donate_form").submit(function(event){
                var reg = /^[0-9]{6}$/;
                var donate_id = $("#donate_id").val();
                if (!reg.test(donate_id)) {
                    show_msg("请输入正确订单号");
                    event.preventDefault();
                }
                $("#payment_method").val(payment_method);
            });
            
            setInterval(function(){
                $.ajax({
                    type: "GET",
                    url: "https://blockchain.info/ticker",
                    dataType: "json",
                    success: function(d) { 
                        $("#btc_price").html(d.USD.last);
                    }
                });
            }, 2000);
            
            update_payment();
        });
        </script>
        
    </HEAD>

    <BODY>
        <div class="container">
            <div class="header clearfix">
                <nav>
                    <ul class="nav nav-pills pull-right">
                        <li role="presentation"><a href="/">首页</a></li>
                        <li role="presentation"><a href="/my.html">我的</a></li>
                        <li role="presentation"><a href="/about.html">关于</a></li>
                        <li role="presentation" class="active"><a href="javascript:void(0);">捐赠</a></li>
                    </ul>
                </nav>
                <h3 class="text-muted">捐赠</h3>
            </div>

            <div class="row">
                <div class="col-sm-6 col-md-4">
                    <div class="thumbnail">
                        <ul class="nav nav-tabs">
                            <li id="tab-wechat" role="presentation" class="active">
                                <a id="wechat" href="javascript:void(0);"><img src="/static/img/wechatpay-logo.jpg"></a>
                            </li>
                            <li id="tab-alipay" role="presentation">
                                <a id="alipay" href="javascript:void(0);"><img src="/static/img/alipay-logo.jpg"></a>
                            </li>
                        </ul>
                        <img id="payment-qr" src="/static/img/wechatpay-qr.jpg">
                        <div class="caption">
                            <h3>感谢您的支持!</h3>
                            <p>永恒之墙上的每一条信息发布都需要支付一些比特币作为手续费，所以我们需要您的支持。目前：</p>
                            <p><b>1比特币 = <spin id="btc_price">约6500</spin>美元</b></p>
                            <p>请使用微信或者支付宝扫一扫图中二维码（或者按住二维码识别）。</p>
                            <p>建议您的捐赠金额为 9、19、99、199 等。</p>
                            <p>
                        </div>
                        <form id="donate_form" method="post">    
                            <input id="payment_method" name="method" type="hidden" required />
                            <label>填写捐赠订单号后6位，我们将优先审核您的信息：</label>
                            <p>【】</p>
                            <div class="input-group">
                                <input id="donate_id" class="form-control" name="donate_id" type="text" placeholder="捐赠订单号的后6位" value="" maxlength="6" required />
                                <span class="input-group-btn">
                                    <button class="btn btn-default" type="submit">确定</button>
                                </span>
                            </div>
                        </form>
                        <div id="msg" class="alert alert-warning" role="alert" style="display:none"></div>
                    </div>
                </div>
                <div class="col-lg-12">
                </div>
            </div>

            <footer class="footer">
                <p>&copy; https://eternitywall.cn</p>
            </footer>

        </div>
    </BODY>
</HTML>
